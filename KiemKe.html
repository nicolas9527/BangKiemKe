<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bang Kiem Ke</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://github.com/nicolas9527/BangKiemKe/blob/main/icon.png.PNG?raw=true">

  <!-- Icon cho thiáº¿t bá»‹ Apple -->
  <link rel="apple-touch-icon" href="https://github.com/nicolas9527/BangKiemKe/blob/main/icon.png.PNG?raw=true">
</head>
<body>
  <h1>Welcome to Bang Kiem Ke</h1>
</body>
</html>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, Arial;
    background: linear-gradient(#eef7ee,#e3f2e1);
    margin: 0;
    padding: 12px;
}

.container {
    background: #ffffff;
    border-radius: 18px;
    padding: 14px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
}

h2 {
    text-align: center;
    color: #2e7d32;
    margin: 6px 0 14px;
}

.control-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #e8f5e9;
    padding: 10px;
    border-radius: 14px;
    margin-bottom: 14px;
}

.ctrl-btn {
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.ctrl-btn.sub {
    width: 44px;
    height: 44px;
    background: #a5d6a7;
    color: #1b5e20;
    font-size: 22px;
}

.ctrl-btn.main {
    width: 54px;
    height: 54px;
    background: linear-gradient(#43a047,#2e7d32);
    color: #fff;
    font-size: 24px;
}

.ctrl-btn:active { transform: scale(0.92); }

.row {
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    align-items: center;
    gap: 8px;
    padding: 10px 0;
}

.label {
    font-size: 18px;
    font-weight: 600;
    color: #2e7d32;
}

input {
    width: 70px;
    height: 34px;
    font-size: 16px;
    border-radius: 8px;
    border: 1.5px solid #a5d6a7;
    background: #f1f8e9;
    text-align: center;
    outline: none;
}

.plus {
    width: 36px;
    height: 36px;
    background: #43a047;
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 22px;
}

.total {
    min-width: 90px;
    text-align: right;
    font-weight: bold;
    font-size: 18px;
    color: #1b5e20;
}

.hr {
    border-bottom: 2px dashed #c8e6c9;
    margin: 4px 0;
}

.summary {
    background: #f1f8e9;
    border-radius: 14px;
    padding: 12px;
    margin-top: 14px;
}

.summary p {
    margin: 6px 0;
    font-size: 16px;
}
</style>
</head>

<body>
<div class="container">
<h2>ðŸ“¦ KIá»‚M KÃŠ</h2>

<div class="control-bar">
    <button class="ctrl-btn sub" onclick="undo()">âŸ²</button>
    <button class="ctrl-btn main" onclick="resetAll()">âŸ²âŸ²</button>
    <button class="ctrl-btn sub" onclick="redo()">âŸ³</button>
</div>

<div id="rows"></div>

<div class="summary">
<p>Tá»•ng cá»™ng: <b id="grand">0</b></p>
<p>Tá»“n há»‡ thá»‘ng:
<input type="number" inputmode="numeric" id="system" oninput="calcDiff()">
</p>
<p>ChÃªnh lá»‡ch: <b id="diff">â€”</b></p>
</div>
</div>

<script>
const items = [
 {id:'lon',label:'Lon (x1)',f:1},
 {id:'loc6',label:'Lá»‘c (x6)',f:6},
 {id:'loc4',label:'Lá»‘c (x4)',f:4},
 {id:'th24',label:'ThÃ¹ng (x24)',f:24},
 {id:'th48',label:'ThÃ¹ng (x48)',f:48}
];

let history=[], future=[];

function save(){
    history.push(document.body.innerHTML);
    future=[];
}

function restore(s){
    document.body.innerHTML=s;
}

function undo(){
    if(history.length){
        future.push(document.body.innerHTML);
        restore(history.pop());
    }
}

function redo(){
    if(future.length){
        history.push(document.body.innerHTML);
        restore(future.pop());
    }
}

/* âœ… RESET AN TOÃ€N â€“ KHÃ”NG RELOAD */
function resetAll(){
    if(!confirm("Reset toÃ n bá»™ dá»¯ liá»‡u?")) return;

    document.querySelectorAll("input").forEach(i => i.value = "");
    document.querySelectorAll(".total").forEach(t => t.innerText = "0");

    grand.innerText = "0";
    diff.innerText = "â€”";
    diff.style.color = "#1565c0";

    history = [];
    future = [];
}

/* âœ… Cá»˜NG Dá»’N ÄÃšNG */
function add(id, f){
    save();

    const input = document.getElementById(id);
    const totalEl = document.getElementById('t_'+id);

    const added = Number(input.value || 0) * f;
    const current = Number(totalEl.innerText || 0);

    totalEl.innerText = current + added;
    input.value = '';

    calcTotal();
}

function calcTotal(){
    let sum = 0;
    document.querySelectorAll('.total').forEach(e=>{
        sum += Number(e.innerText || 0);
    });
    grand.innerText = sum;
    calcDiff();
}

function calcDiff(){
    let t = Number(grand.innerText);
    let s = Number(system.value || 0);
    let d = t - s;

    if(d > 0){
        diff.innerText = 'DÆ° ' + d;
        diff.style.color = '#2e7d32';
    } else if(d < 0){
        diff.innerText = 'Thiáº¿u ' + Math.abs(d);
        diff.style.color = '#c62828';
    } else {
        diff.innerText = 'Äá»§';
        diff.style.color = '#1565c0';
    }
}

/* RENDER ROW */
const rows = document.getElementById('rows');
items.forEach((it,i)=>{
    rows.innerHTML += `
    <div class="row">
        <div class="label">${it.label}</div>
        <input type="number" inputmode="numeric" id="${it.id}">
        <button class="plus" onclick="add('${it.id}',${it.f})">+</button>
        <div class="total" id="t_${it.id}">0</div>
    </div>
    ${i < items.length-1 ? '<div class="hr"></div>' : ''}
    `;
});
</script>
</body>
</html>