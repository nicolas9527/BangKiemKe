<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">

<title>Ki·ªÉm K√™</title>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, Arial;
    background: linear-gradient(#eef7ee,#e3f2e1);
    margin: 0;
    padding: 12px;
}

.container {
    background: #ffffff;
    border-radius: 18px;
    padding: 14px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
}

h2 {
    text-align: center;
    color: #2e7d32;
    margin: 6px 0 14px;
}

/* CONTROL BAR */
.control-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #e8f5e9;
    padding: 10px;
    border-radius: 14px;
    margin-bottom: 14px;
}

.ctrl-btn {
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.ctrl-btn.sub {
    width: 44px;
    height: 44px;
    background: #a5d6a7;
    color: #1b5e20;
    font-size: 22px;
}

.ctrl-btn.main {
    width: 54px;
    height: 54px;
    background: linear-gradient(#43a047,#2e7d32);
    color: #fff;
    font-size: 24px;
}

.ctrl-btn:active { transform: scale(0.92); }

/* ROW */
.row {
    display: grid;
    grid-template-columns: 1fr auto auto;
    align-items: center;
    gap: 8px;
    padding: 10px 0;
}

.label {
    font-size: 18px;
    font-weight: 600;
    color: #2e7d32;
}

/* INPUT FIX ZOOM */
input {
    width: 70px;
    height: 34px;
    font-size: 16px; /* QUAN TR·ªåNG: CH·ªêNG iOS ZOOM */
    border-radius: 8px;
    border: 1.5px solid #a5d6a7;
    background: #f1f8e9;
    text-align: center;
    outline: none;
}

.plus {
    width: 36px;
    height: 36px;
    background: #43a047;
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 22px;
}

.total {
    width: 36px;
    text-align: right;
    font-weight: bold;
    font-size: 18px;
    color: #1b5e20;
}

/* DASH LINE */
.hr {
    border-bottom: 2px dashed #c8e6c9;
    margin: 4px 0;
}

/* SUMMARY */
.summary {
    background: #f1f8e9;
    border-radius: 14px;
    padding: 12px;
    margin-top: 14px;
}

.summary p {
    margin: 6px 0;
    font-size: 16px;
}
</style>
</head>

<body>
<div class="container">
<h2>üì¶ KI·ªÇM K√ä</h2>

<div class="control-bar">
    <button class="ctrl-btn sub" onclick="undo()">‚ü≤</button>
    <button class="ctrl-btn main" onclick="resetAll()">‚ü≤‚ü≤</button>
    <button class="ctrl-btn sub" onclick="redo()">‚ü≥</button>
</div>

<div id="rows"></div>

<div class="summary">
<p>T·ªïng c·ªông: <b id="grand">0</b></p>
<p>T·ªìn h·ªá th·ªëng:
<input type="number" inputmode="numeric" pattern="[0-9]*" id="system" oninput="calcDiff()">
</p>
<p>Ch√™nh l·ªách: <b id="diff">‚Äî</b></p>
</div>

</div>

<script>
const items = [
 {id:'lon',label:'Lon (x1)',f:1},
 {id:'loc6',label:'L·ªëc (x6)',f:6},
 {id:'loc4',label:'L·ªëc (x4)',f:4},
 {id:'th24',label:'Th√πng (x24)',f:24},
 {id:'th48',label:'Th√πng (x48)',f:48}
];

let history=[], future=[];

function save(){ history.push(document.body.innerHTML); future=[]; }
function restore(s){ document.body.innerHTML=s; }
function undo(){ if(history.length){ future.push(document.body.innerHTML); restore(history.pop()); } }
function redo(){ if(future.length){ history.push(document.body.innerHTML); restore(future.pop()); } }
function resetAll(){ location.reload(); }

function add(id,f){
 save();
 let i=document.getElementById(id);
 let v=Number(i.value||0)*f;
 document.getElementById('t_'+id).innerText=v;
 i.value='';
 calcTotal();
}

function calcTotal(){
 let s=0;
 document.querySelectorAll('.total').forEach(e=>s+=Number(e.innerText));
 document.getElementById('grand').innerText=s;
 calcDiff();
}

function calcDiff(){
 let t=Number(grand.innerText);
 let s=Number(system.value||0);
 let d=t-s;
 let el=diff;
 if(d>0){ el.innerText='D∆∞ '+d; el.style.color='#2e7d32'; }
 else if(d<0){ el.innerText='Thi·∫øu '+Math.abs(d); el.style.color='#c62828'; }
 else{ el.innerText='ƒê·ªß'; el.style.color='#1565c0'; }
}

const rows=document.getElementById('rows');
items.forEach((it,i)=>{
 rows.innerHTML+=`
 <div class="row">
  <div class="label">${it.label}</div>
  <input type="number" inputmode="numeric" pattern="[0-9]*" id="${it.id}">
  <button class="plus" onclick="add('${it.id}',${it.f})">+</button>
  <div class="total" id="t_${it.id}">0</div>
 </div>
 ${i<items.length-1?'<div class="hr"></div>':''}
 `;
});
</script>
</body>
</html>